<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>OS | Home</title><meta name=keywords content><meta name=description content="This is Chancellor16's Blog"><meta name=author content="Chan"><link rel=canonical href=/tags/os/><meta name=google-site-verification content="XYZabc"><meta name=yandex-verification content="XYZabc"><meta name=msvalidate.01 content="XYZabc"><link crossorigin=anonymous href=/assets/css/stylesheet.6a98292fb8fa8cf0f3ba4042d4b75515c04267550f3ad49ff6271b5af9562443.css integrity="sha256-apgpL7j6jPDzukBC1LdVFcBCZ1UPOtSf9icbWvlWJEM=" rel="preload stylesheet" as=style><link rel=icon href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=16x16 href=%3Clink%20/%20abs%20url%3E><link rel=icon type=image/png sizes=32x32 href=%3Clink%20/%20abs%20url%3E><link rel=apple-touch-icon href=%3Clink%20/%20abs%20url%3E><link rel=mask-icon href=%3Clink%20/%20abs%20url%3E><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=/tags/os/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(e,t,n,s,o,i,a){e.GoogleAnalyticsObject=o,e[o]=e[o]||function(){(e[o].q=e[o].q||[]).push(arguments)},e[o].l=1*new Date,i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)}(window,document,"script","https://www.google-analytics.com/analytics.js","ga"),ga("create","UA-123-45","auto"),ga("send","pageview"))</script><meta property="og:title" content="OS"><meta property="og:description" content="This is Chancellor16's Blog"><meta property="og:type" content="website"><meta property="og:url" content="/tags/os/"><meta property="og:image" content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="Chancellor16's Blog"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="OS"><meta name=twitter:description content="This is Chancellor16's Blog"></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href accesskey=h title="Cheyne16's Blog (Alt + H)"><img src=/apple-touch-icon.png alt aria-label=logo height=35>Cheyne16's Blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=/categories/ title=categories><span>categories</span></a></li><li><a href=/tags/ title=tags><span>tags</span></a></li><li><a href=https://example.org title=example.org><span>example.org</span>&nbsp;<svg fill="none" shape-rendering="geometricPrecision" stroke="currentcolor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href>Home</a>&nbsp;»&nbsp;<a href=/tags/>Tags</a></div><h1>OS
<a href=index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class="post-entry tag-entry"><header class=entry-header><h2>王道 Part1 概述</h2></header><div class=entry-content><p>1 综述 程序接口：一组系统调用
命令接口：
联机命令接口：=交互式命令接口，用户说一句， 系统跟着做一句，如cmd 脱机命令接口：=批处理命令接口，用户说一堆， 系统跟着做一堆，如 *.bat文件 2 特征 并发：表面同时进行，实际交替进行，比如一个CPU同时运行多任务 并行：真正同时进行，如多个CPU，每个CPU运行一个任务
如果失去并发性，则系统中只有一个程序正在运行，则共享性失去存在的意义； 如果失去共享性，则QQ和微信不能同时访问硬盘资源，就无法实现同时发送文件，也就无法并发。
如果失去了并发性，则一个时间段内系统中只需运行一道程序，那么就失去了实现虚拟性的意义了。因此，没有并发性，就谈不上虚拟性。
异步是指，在多道程序环境下，允许多个程序并发执行，但由于资源有限，进程的执行不是一贯到底的， 而是走走停停，以不可预知的速度向前推进，这就是进程的异步性。如果失去了并发性，即系统只能串行地运行各个程序，那么每个程序的执行会一贯到底。只有系统拥有并发性，才有可能导致异步性。
3 发展和分类 多道批处理系统阶段：操作系统正式诞生，用于持多道程序并发运行
4 运行机制 4.1 计算机系统的层次结构 4.2 内核 内核是计算机上配置的底层==软件==，是操作系统最基本、最核心的部分
操作系统的内核程序是系统的管理者， 既可以执行特权指令，也可以执行非特权指令
但是，操作系统的功能未必都在内核里，比如GUI。操作系统分为内核部分和非内核部分。内核只是操作系统最核心重要的部分。
4.3 内核态-用户态 CPU 中有一个寄存器叫 ==程序状态字寄存器==（PSW），其中有个二进制位，1表示 “内核态”，0表示“用户态” 别名：内核态=核心态= ==管态==；用户态= ==目态==
程序状态字（PSW）寄存器用于记录当前处理器的状态和控制指令的执行顺序，并且保留与运行程序相关的各种信息，主要作用是实现程序状态的保护和恢复。 所以中断处理程序要将PSW保存，子程序调用在进程内部执行，不会更改PSW。
内核态 —> 用户态：执行一条特权指令——修改PSW的标志位为“用户态”，这个动作意味着操作系统将主动让出CPU使用权 用户态 —> 内核态：由“中断”引发，硬件自动完成变态过程，触发中断信号意味着操作系统将强行夺回CPU的使用权
4.4 操作系统的体系结构 此处只讲了两种：
大内核/宏内核/单内核： Linux、UNIX
微内核： Windows NT
微内核降低性能举例：
4.5 总结 5 中断和异常 “中断”是让操作系统内核夺回CPU使用权的唯一途径
如果没有“中断”机制，那么一旦应用程序上CPU运行，CPU就会一直运行这个应用程序
内中断/外中断：与当前执行的指令有无关系；中断信号来源于CPU内部还是外部
==举例==
内中断 试图在用户态下执行特权指令 —-abort 【abort：由致命错误引起，内核程序无法 修复该错误，因此一般不再将CPU 使用权还给引发终止的应用程序， 而是直接终止该应用程序】 执行除法指令时发现除数为 0 —-abort 系统调用 —-trap 【trap：有时候应用程序想请求操作系统内核的服务，此时会执行一条特殊的指令——陷入指令，该指令会引发一个内部中断信号（执行“陷入指令”，意味着应用程序主动地将CPU控制权还给操作系统内核。 “系统调用”就是通过陷入指令完成的）】 缺页故障 —-fault 【fault：由错误条件引起的，可能被内核程序修复。内核程序修复故障后会把 CPU使用权还给应用程序，让它继续执行 下去】 外中断 时钟中断——由时钟部件发来的中断信号（时钟部件每隔一个时间 片（如 50ms）会给CPU 发送一个时钟中断信号） I/O中断——由输入/输出设备发来的中断信号（当输入输出任务完成时， 向CPU发送中断信号） 大多数的教材、试卷中，“中断”特指狭义的中断，即外中断。而内中断一般称为“异常”...</p></div><footer class=entry-footer><span title='2023-02-21 16:29:43 +0000 UTC'>February 21, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;154 words&nbsp;·&nbsp;Chan</footer><a class=entry-link aria-label="post link to 王道 Part1 概述" href=/posts/os/%E7%8E%8B%E9%81%93-part1-%E6%A6%82%E8%BF%B0/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>王道 Part2 进程管理</h2></header><div class=entry-content><p>==1 进程组成== 1.1 PCB PCB不包括==user data==
1.2 总结 PCB 是给 操作系统 用的； 程序段、数据段是 给进程自己用的， 与进程自身的运行 逻辑有关。
进程是动态的，进程实体（进程映像）是静态的。 进程实体反应了进程在某一时刻的状态（如：x++后，x=2）。
进程是进程实体的运行过程，是系统进行资源分配和调度的一个独立单位。
程序是静态的，进程是动态的。进程是程序的一次执行过程，动态地产生、变化、消亡。
2 进程的组织方式 3 进程状态与转换 进程PCB中，会有一个变量 state 来表示进程的当前状态。如：1表示创建态、2表示就绪态、3表示运行态… 为了对同一个状态下的各个进程进行统一的管理，操作系统会将各个进程的PCB组织起来。
进程的整个生命周期 中，大部分时间都处 于三种基本状态。
单CPU情况下，同一时刻只会有一 个进程处于运行态，多核CPU情况 下，可能有多个进程处于运行态
4 进程控制 如果不能“一气呵成”，就有可能导致操作系 统中的某些关键数据结构信息不统一的情况， 这会影响操作系统进行别的管理工作。
4.1 如何实现原语的“原子性”？ 原语的执行具有原子性，即执行过程只能一气呵成，期间不允许被中断。 可以用 “关中断指令”和“开中断指令”这两个特权指令实现原子性。
==正常情况==：CPU每执行完一条指令都会例 行检查是否有中断信号需要处理，如果有， 则暂停运行当前这段程序，转而执行相应 的中断处理程序。中断处理结 束之后也不一定 会直接回到原进 程执行。
==原语==：CPU执行了关中断指令之后，就不再例行 检查中断信号，直到执行开中断指令之后 才会恢复检查。 这样，关中断、开中断 之间的这些指令序 列就是不可被中断的，这就实现了“原子 性”
4.2 进程控制相关的原语 5 进程通信 进程是分配系统资源的单位（包括内存地址空间），因此各进程拥有的内存地址空间相互独立。
为了保证安全，一个进程不能直接访问另一个进程的地址空间。但是进程之间的信息交换又是必须实现的。 为了保证进程间的安全通信，操作系统提供了一些方法。
共享内存：
基于数据结构的共享：比如共享空间里只能放 一个长度为10的数组。这种共享方式速度慢、 限制多，是一种低级通信方式 基于存储区的共享：在内存中画出一块共享存 储区，数据的形式、存放位置都由进程控制， 而不是操作系统。相比之下，这种共享方式速 度更快，是一种高级通信方式。 消息传递：...</p></div><footer class=entry-footer><span title='2023-02-21 16:29:43 +0000 UTC'>February 21, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;281 words&nbsp;·&nbsp;Chan</footer><a class=entry-link aria-label="post link to 王道 Part2 进程管理" href=/posts/os/%E7%8E%8B%E9%81%93-part2-%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>王道 Part3 内存管理</h2></header><div class=entry-content><p>1 预备知识 逻辑地址 to 物理地址：（地址绑定）
==绝对装入==：在编译的时候就转换为最终的地址。需要提前知道装入模块要装到哪，只适用于单道程序环境。 ==静态重定位/可重定位装入==：编译链接后还是从0开始，装入内存的时候转换为最终的地址。要求装入的内存连续且运行中不能移动。 ==动态重定位/动态运行时装入==：（现在使用的）装入内存后不一定立刻转换，而是在程序真正执行时转换。转换用到重定位寄存器。装入的内存可以不连续且运行中可以移动。（需要基址MMU） 链接的三种方式：
静态链接：先链接成一个装入模块，再装入 装入时动态链接：所有模块边装入边链接 运行时动态链接：用到的模块边装入边链接 2 内存管理概述 内存空间的分配与回收 连续分配——单一、固定分区、动态分区 非连续分配——基本分页、段、段页 内存空间的扩充 覆盖技术 交换技术 虚拟存储技术 地址转换 编译时绑定 加载时绑定 （可重定位装入） 运行时绑定 存储保护——利用寄存器 3 内存空间的分配与回收 3.1 连续分配管理方式 3.1.1 单一连续分配 分为系统区和用户区
只能有一道用户程序
有内部碎片（分配给某进程的内存中没用上的部分）
3.1.2 固定分区分配 把用户区划分为若干个固定大小的分区
可进行多道用户程序
数据结构——分区说明表：每个分区的大小、起始状态、是否已分配（状态）
有内部碎片（分配给某进程的内存中没用上的部分）
3.1.3 动态分区分配 进程装入内存时，动态建立分区
系统分区的大小和数目是可变的
数据结构——空闲分区表/空闲分区链
动态分区分配算法
首次适应算法（first fit）—— 从低地址开始查找第一个能满足大小的空闲分区（按地址大小排列） 最佳适应算法（best fit）——优先使用更小的空闲分区（按容量递增排列）—> 会产生很多碎片 最坏适应算法（worst fit）——同最佳适应算法相反—>大进程无法进行了 邻近适应算法（next fit）——在首次适应算法上改进：每次从上次查找结束的位置开始查找，减少开销 只有外部碎片（内存中某些空闲分区由于太小了不能用）——用紧凑技术来解决
3.2 非连续分配管理方式 3.2.0 总结 ==访存次数==
基本分页、分段：2 ——- 先表后内存 具有快表的分页： 多级页表：n级——n+1次 段页式：3 ———— 段表 页表 内存 ==判断越界==...</p></div><footer class=entry-footer><span title='2023-02-21 16:29:43 +0000 UTC'>February 21, 2023</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;292 words&nbsp;·&nbsp;Chan</footer><a class=entry-link aria-label="post link to 王道 Part3 内存管理" href=/posts/os/%E7%8E%8B%E9%81%93-part3-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>王道 Part4 文件管理</h2></header><div class=entry-content><p>1 文件管理简介 2 文件的逻辑结构 3 文件目录 4 文件的物理结构 5 物理结构 vs 逻辑结构</p></div><footer class=entry-footer><span title='2023-02-21 16:29:43 +0000 UTC'>February 21, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;12 words&nbsp;·&nbsp;Chan</footer><a class=entry-link aria-label="post link to 王道 Part4 文件管理" href=/posts/os/%E7%8E%8B%E9%81%93-part4-%E6%96%87%E4%BB%B6%E7%AE%A1%E7%90%86/></a></article><article class="post-entry tag-entry"><header class=entry-header><h2>王道 Part5 IO-Systems</h2></header><div class=entry-content><p>设备管理</p></div><footer class=entry-footer><span title='2023-02-21 16:29:43 +0000 UTC'>February 21, 2023</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;word&nbsp;·&nbsp;Chan</footer><a class=entry-link aria-label="post link to 王道 Part5 IO-Systems" href=/posts/os/%E7%8E%8B%E9%81%93-part5-io-systems/></a></article><footer class=page-footer><nav class=pagination><a class=prev href=/tags/os/>«&nbsp;Prev&nbsp;</a>
<a class=next href=/tags/os/page/3/>Next&nbsp;&nbsp;»</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href>Home</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>